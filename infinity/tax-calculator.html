<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Myanmar Income Tax Calculator</title>
    <link rel="stylesheet" href="../css/style2.css">
</head>

<body>
    <div class="container">
        <h1>Myanmar Income Tax Calculator (April - March)</h1>

        <!-- Income Input -->
        <form id="tax-form">
            <h3>Enter your monthly income (April to March):</h3>

            <div id="monthly-inputs"></div>

            <button type="button" onclick="calculateTax()">Calculate Tax</button>
        </form>

        <!-- Tax Result -->
        <div id="result" class="result-container"></div>

        <!-- Download Button -->
        <button id="download-btn" style="display: none;" onclick="downloadResult()">Download Result</button>

        <a href="../knowledge.html" class="back-btn">Back to Knowledge</a>
    </div>

    <script>
        // Generate input fields for 12 months (April - March)
        const monthlyInputs = document.getElementById('monthly-inputs');
        const months = [
            "April", "May", "June", "July", "August", "September",
            "October", "November", "December", "January", "February", "March"
        ];

        months.forEach((month, index) => {
            monthlyInputs.innerHTML += `
                <label>${month}:</label>
                <input type="number" id="month-${index}" placeholder="Enter ${month} income" required><br>
            `;
        });

        // Myanmar Income Tax Calculation
        function calculateTax() {
            const monthlyIncomes = months.map((_, i) => parseFloat(document.getElementById(`month-${i}`).value) || 0);
            const annualIncome = monthlyIncomes.reduce((a, b) => a + b, 0);
            let tax = 0;

            if (annualIncome > 4800000) {
                const taxableIncome = annualIncome; 

                const taxBrackets = [
                    { limit: 2000000, rate: 0 },
                    { limit: 10000000, rate: 0.05 },
                    { limit: 30000000, rate: 0.10 },
                    { limit: 50000000, rate: 0.15 },
                    { limit: 70000000, rate: 0.20 },
                    { limit: Infinity, rate: 0.25 },
                ];

                let remainingIncome = taxableIncome;

                for (const bracket of taxBrackets) {
                    if (remainingIncome <= 0) break;
                    const amountInBracket = Math.min(remainingIncome, bracket.limit);
                    tax += amountInBracket * bracket.rate;
                    remainingIncome -= bracket.limit;
                }
            }

            displayResult(annualIncome, tax);
        }

        // Display Tax Calculation Result
        function displayResult(income, tax) {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = `
                <h3>Tax Calculation Result:</h3>
                <p>Annual Income: ${income.toLocaleString()} Kyats</p>
                <p>Estimated Tax: ${tax.toLocaleString()} Kyats</p>
            `;

            document.getElementById('download-btn').style.display = 'block';
        }

        // Download Tax Report as a Text File
        function downloadResult() {
            const income = months.map((_, i) => document.getElementById(`month-${i}`).value || 0);
            const totalIncome = income.reduce((a, b) => parseFloat(a) + parseFloat(b), 0);
            const result = document.getElementById('result').textContent;

            const content = `Myanmar Income Tax Report (April to March)
------------------------------------
Monthly Incomes:
${months.map((m, i) => `${m}: ${income[i]} Kyats`).join("\n")}
------------------------------------
${result}`;

            const blob = new Blob([content], { type: 'text/plain' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'income_tax_report.txt';
            link.click();
        }
    </script>
</body>

</html>

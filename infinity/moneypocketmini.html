<!DOCTYPE html>
<html lang="my">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>á€á€®á€á€„á€ºá€¸á€€á€»á€½á€á€º á€™á€¯á€”á€·á€ºá€–á€­á€¯á€¸á€á€±á€…á€”á€…á€º</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Padauk:wght@400;700&display=swap" rel="stylesheet">
    
    <!-- Firebase SDKs -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, getDoc, setDoc, onSnapshot } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        import { setLogLevel } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        
        // Expose Firebase objects globally for use in the main script block
        window.firebase = { initializeApp, getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged, getFirestore, doc, getDoc, setDoc, onSnapshot, setLogLevel };
    </script>
    
    <!-- Chosen Palette: Festive Gold/Red with Clean Neutrals -->
    <!-- Application Structure Plan: Three main views controlled by JS state: 1. Admin Panel (Secured Login/Config/Results Table). 2. Loading/Setup Screen. 3. Public Game View (Member Selection / Wheel Spin). Uses Firestore for shared state management of the game parameters, available prizes, and individual member spin results. The wheel segments are dynamically generated based on available (unallocated) prizes/colors. -->
    <!-- Visualization & Content Choices: Goal: Multi-user sequential spinning with hidden prize amounts. Viz/Presentation Method: Spin Wheel (CSS/JS animation) showing colors only. Admin Results Table (HTML/Tailwind) showing all hidden data. Interaction: Secure login to admin panel. Member selection to identify the spinner. Atomic update to Firestore on successful spin. Admin Reset button for individual member corrections. Justification: Firestore is necessary for multi-user state persistence and real-time result tracking. Hiding the amount on the wheel meets the user's secrecy requirement. Library/Method: Vanilla JavaScript + Firestore for state/logic, CSS animations for the wheel effect, Tailwind CSS for all styling. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Padauk', sans-serif;
            background-color: #FDFBF6;
        }
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(1080deg); } 
        }
        .spinning {
            animation: spin 3s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards; /* Ease-in-out for realistic spin */
        }
        .wheel-circle {
            transition: transform 3s ease-out;
            border-radius: 50%;
            overflow: hidden;
            box-shadow: inset 0 0 10px rgba(0,0,0,0.3);
        }
        .wheel-circle::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 10;
            pointer-events: none;
            box-shadow: 0 0 0 10px #FBBF24;
            border-radius: 50%;
        }
        .wheel-segment {
            position: absolute;
            top: 0;
            left: 50%;
            width: 50%;
            height: 50%;
            transform-origin: 0% 100%;
        }
        .wheel-pointer {
            position: absolute;
            top: -15px; /* Adjust based on pointer size */
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 10px solid transparent;
            border-right: 10px solid transparent;
            border-bottom: 20px solid #D946EF; /* Purple pointer for visibility */
            z-index: 20;
        }
    </style>
</head>
<body class="text-gray-800">

    <div class="container mx-auto px-4 py-8 md:py-12 max-w-4xl">

        <header class="text-center mb-8">
            <h1 class="text-3xl md:text-4xl font-bold text-yellow-900">ğŸ® á€á€®á€á€„á€ºá€¸á€€á€»á€½á€á€º á€™á€¯á€”á€·á€ºá€–á€­á€¯á€¸á€á€±á€…á€”á€…á€º ğŸ®</h1>
            <p class="text-gray-600 mt-2">Testing Team á€¡á€á€½á€€á€º á€á€…á€ºá€¦á€¸á€á€»á€„á€ºá€¸á€†á€¯á€™á€²á€…á€”á€…á€º</p>
        </header>

        <main class="bg-white/60 backdrop-blur-sm p-6 md:p-8 rounded-2xl shadow-lg border border-gray-200 min-h-[500px] relative">
            
            <!-- Admin Controls Button -->
            <div class="mb-6 text-center">
                <button id="admin-login-btn" class="text-sm text-red-700 hover:text-red-900 font-semibold underline">
                    âš™ï¸ á€…á€®á€™á€¶á€á€”á€·á€ºá€á€½á€²á€™á€¾á€¯ á€á€„á€ºá€›á€±á€¬á€€á€ºá€›á€”á€º
                </button>
            </div>

            <!-- Loading/Error Screen -->
            <div id="loading-screen" class="absolute inset-0 bg-white/80 flex flex-col items-center justify-center p-4 z-50">
                <div id="loading-spinner" class="animate-spin rounded-full h-12 w-12 border-b-2 border-yellow-700 mb-3"></div>
                <p id="loading-status" class="text-center text-gray-700 font-semibold">á€…á€”á€…á€ºá€…á€á€„á€ºá€”á€±á€•á€«á€á€Šá€º...</p>
            </div>

            <!-- Login Section -->
            <div id="login-section" class="mb-8 border border-red-300 p-4 rounded-xl bg-red-50 hidden">
                <h2 class="text-lg font-bold text-red-800 border-b pb-2 mb-4">á€…á€®á€™á€¶á€á€”á€·á€ºá€á€½á€²á€á€° á€á€„á€ºá€›á€±á€¬á€€á€ºá€á€¼á€„á€ºá€¸</h2>
                <form id="login-form" class="space-y-3">
                    <div>
                        <label for="username" class="block text-sm font-medium text-gray-700">á€¡á€á€¯á€¶á€¸á€•á€¼á€¯á€á€°á€¡á€™á€Šá€º (kmt)</label>
                        <input type="text" id="username" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2" required>
                    </div>
                    <div>
                        <label for="password" class="block text-sm font-medium text-gray-700">á€œá€»á€¾á€­á€¯á€·á€á€¾á€€á€ºá€”á€¶á€•á€«á€á€º</label>
                        <input type="password" id="password" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2" required>
                    </div>
                    <button type="submit" class="w-full bg-red-600 text-white font-bold py-2 rounded-lg hover:bg-red-700 transition-colors">ğŸ” á€á€„á€ºá€›á€±á€¬á€€á€ºá€™á€Šá€º</button>
                    <p id="login-error" class="text-red-500 text-sm mt-2 text-center hidden">á€¡á€á€¯á€¶á€¸á€•á€¼á€¯á€á€°á€¡á€™á€Šá€º (á€á€­á€¯á€·) á€œá€»á€¾á€­á€¯á€·á€á€¾á€€á€ºá€”á€¶á€•á€«á€á€º á€™á€™á€¾á€”á€ºá€€á€”á€ºá€•á€«á‹</p>
                </form>
            </div>

            <!-- Admin Panel (Hidden until successful login) -->
            <div id="admin-panel" class="mb-8 relative border border-green-300 p-4 rounded-2xl bg-green-50 hidden">
                <h2 class="text-xl font-bold text-green-800 border-b pb-2 mb-4">âœ… á€…á€®á€™á€¶á€á€”á€·á€ºá€á€½á€²á€á€° Panel</h2>
                <button id="close-admin-btn" class="absolute top-4 right-4 text-gray-500 hover:text-gray-800 text-xl font-bold p-1">Ã—</button>
                
                <p class="text-sm text-gray-600 mb-4">á€á€á€­á€•á€±á€¸á€á€»á€€á€º: á€¡á€±á€¬á€€á€ºá€•á€«á€á€”á€ºá€–á€­á€¯á€¸á€™á€»á€¬á€¸á€€á€­á€¯ á€•á€¼á€„á€ºá€†á€„á€ºá€•á€¼á€®á€¸á€•á€«á€€ **á€á€­á€™á€ºá€¸á€†á€Šá€ºá€¸á€›á€”á€º** á€á€œá€¯á€á€ºá€€á€­á€¯ á€”á€¾á€­á€•á€ºá€•á€«á‹</p>
                
                <form id="admin-form" class="space-y-4">
                    <h3 class="font-semibold text-lg text-green-700">á. á€¡á€á€¼á€±á€á€¶á€á€á€ºá€™á€¾á€á€ºá€á€»á€€á€ºá€™á€»á€¬á€¸</h3>
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label for="total-amount" class="block text-sm font-medium text-gray-700">á€…á€¯á€…á€¯á€•á€±á€«á€„á€ºá€¸á€„á€½á€±á€•á€™á€¬á€ (MMK)</label>
                            <input type="number" id="total-amount" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2" min="1000" required>
                        </div>
                        <div>
                            <label for="min-amount" class="block text-sm font-medium text-gray-700">á€á€…á€ºá€¦á€¸á€œá€»á€¾á€„á€º á€¡á€”á€Šá€ºá€¸á€†á€¯á€¶á€¸ (MMK)</label>
                            <input type="number" id="min-amount" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2" min="100" required>
                        </div>
                        <div class="col-span-1">
                            <label for="max-amount" class="block text-sm font-medium text-gray-700">á€á€…á€ºá€¦á€¸á€œá€»á€¾á€„á€º á€¡á€™á€»á€¬á€¸á€†á€¯á€¶á€¸ (MMK)</label>
                            <input type="number" id="max-amount" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2" min="100" required>
                        </div>
                        <div class="col-span-1">
                            <label class="block text-sm font-medium text-gray-700">á€œá€€á€ºá€›á€¾á€­á€¡á€–á€½á€²á€·á€á€„á€ºá€¦á€¸á€›á€±</label>
                            <p id="member-count" class="mt-1 text-2xl font-bold text-green-700 p-2"></p>
                        </div>
                    </div>
                    <div>
                        <label for="team-members" class="block text-sm font-medium text-gray-700">á€¡á€–á€½á€²á€·á€á€„á€ºá€…á€¬á€›á€„á€ºá€¸ (á€á€…á€ºá€€á€¼á€±á€¬á€„á€ºá€¸á€…á€®á€á€½á€²á€›á€±á€¸á€•á€«)</label>
                        <textarea id="team-members" rows="4" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2" required></textarea>
                    </div>

                    <h3 class="font-semibold text-lg text-green-700 mt-6">á‚. á€†á€¯á€•á€™á€¬á€ á€á€á€ºá€™á€¾á€á€ºá€á€¼á€„á€ºá€¸ (á‰ á€™á€»á€­á€¯á€¸)</h3>
                    <div id="prize-setup-container" class="space-y-2">
                        <!-- Prize inputs generated by JS -->
                    </div>
                    
                    <button type="submit" class="w-full bg-green-600 text-white font-bold py-3 rounded-lg hover:bg-green-700 transition-colors">ğŸ’¾ á€¡á€á€»á€€á€ºá€¡á€œá€€á€ºá€™á€»á€¬á€¸ á€á€­á€™á€ºá€¸á€†á€Šá€ºá€¸á€›á€”á€º</button>
                    <p id="admin-message" class="text-sm mt-2 text-center font-semibold text-green-600 hidden"></p>
                </form>

                <h3 class="text-xl font-bold text-green-800 mt-8 border-t pt-4">áƒ. á€œá€€á€ºá€›á€¾á€­ á€›á€œá€’á€ºá€™á€»á€¬á€¸ (á€œá€»á€¾á€­á€¯á€·á€á€¾á€€á€ºá€á€»á€€á€º)</h3>
                <p class="text-sm text-gray-600 mb-4">á€˜á€šá€ºá€á€°á€€ á€˜á€šá€ºá€¡á€›á€±á€¬á€„á€ºá€”á€²á€· á€˜á€šá€ºá€œá€±á€¬á€€á€ºá€›á€á€½á€¬á€¸á€œá€²á€†á€­á€¯á€á€¬ á€¡á€±á€¬á€€á€ºá€™á€¾á€¬ á€á€­á€¯á€€á€ºá€›á€­á€¯á€€á€ºá€•á€±á€«á€ºá€”á€±á€•á€«á€á€šá€ºá‹</p>
                <div class="overflow-x-auto">
                    <table class="min-w-full bg-white rounded-lg shadow-md">
                        <thead>
                            <tr class="bg-green-100 text-sm font-medium text-green-800">
                                <th class="p-3 text-left">á€¡á€–á€½á€²á€·á€á€„á€ºá€¡á€™á€Šá€º</th>
                                <th class="p-3 text-center">á€¡á€á€¼á€±á€¡á€”á€±</th>
                                <th class="p-3 text-center">á€¡á€›á€±á€¬á€„á€º</th>
                                <th class="p-3 text-right">á€„á€½á€±á€•á€™á€¬á€ (MMK)</th>
                                <th class="p-3 text-center">Reset</th>
                            </tr>
                        </thead>
                        <tbody id="admin-results-table">
                            <!-- Real-time results populated by JS -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Public Game View (Wheel & Selection) -->
            <div id="game-view" class="flex flex-col items-center justify-center p-6 md:p-8 hidden">
                <h3 class="text-lg font-bold text-yellow-800 mb-4">ğŸ‰ á€™á€¯á€”á€·á€ºá€–á€­á€¯á€¸á€œá€¾á€Šá€·á€ºá€›á€”á€º</h3>
                
                <!-- Member Selector -->
                <div class="w-full max-w-xs mb-6">
                    <label for="spinner-select" class="block text-sm font-medium text-gray-700 mb-2">á€á€„á€·á€ºá€¡á€™á€Šá€ºá€€á€­á€¯ á€›á€½á€±á€¸á€á€»á€šá€ºá€•á€«:</label>
                    <select id="spinner-select" class="block w-full rounded-md border-gray-300 shadow-sm p-2 bg-white text-lg font-semibold">
                        <option value="" disabled selected>--- á€›á€½á€±á€¸á€á€»á€šá€ºá€•á€« ---</option>
                    </select>
                </div>
                
                <!-- Wheel Area -->
                <div class="relative w-64 h-64 mb-8">
                    <div id="wheel" class="wheel-circle w-full h-full border-4 border-yellow-700 relative">
                        <!-- Segments will be inserted here by JS -->
                    </div>
                    <div class="wheel-pointer"></div>
                </div>

                <button id="generate-btn" class="w-full max-w-xs bg-red-600 text-white font-bold py-4 px-4 rounded-full text-xl hover:bg-red-700 transition-all duration-300 shadow-lg hover:shadow-xl focus:outline-none focus:ring-4 focus:ring-red-300" disabled>
                    ğŸ’° á€œá€¾á€Šá€·á€ºá€™á€Šá€º
                </button>
                <p id="spin-status" class="mt-4 text-center text-sm text-gray-600 h-6"></p>

                <!-- Individual Result Display -->
                <div id="individual-result" class="mt-6 p-4 rounded-xl shadow-xl border-t-4 border-yellow-500 bg-yellow-50 w-full max-w-xs text-center hidden">
                    <div class="font-bold text-xl text-yellow-900 mb-2">á€›á€œá€’á€º</div>
                    <p class="text-gray-700">á€á€„á€ºá€›á€›á€¾á€­á€á€±á€¬á€†á€¯á€™á€¾á€¬:</p>
                    <div id="result-color-display" class="font-extrabold text-2xl mt-1 p-2 rounded-lg text-white shadow-md"></div>
                    <p class="text-sm text-gray-500 mt-2">(á€„á€½á€±á€•á€™á€¬á€á€€á€­á€¯ Admin Panel á€á€½á€„á€º á€á€­á€™á€ºá€¸á€†á€Šá€ºá€¸á€‘á€¬á€¸á€•á€«á€á€Šá€º)</p>
                </div>

                <div id="reset-info" class="mt-6 p-4 bg-gray-100 rounded-lg text-sm text-gray-600 hidden w-full max-w-xs text-center">
                    á€‚á€­á€™á€ºá€¸á€¡á€á€…á€ºá€…á€á€„á€ºá€›á€”á€º Admin á€™á€¾á€á€¬ á€•á€¼á€”á€ºá€œá€Šá€ºá€á€á€ºá€™á€¾á€á€ºá€”á€­á€¯á€„á€ºá€•á€«á€á€Šá€ºá‹
                </div>
            </div>
            
        </main>

        <footer class="text-center mt-8 text-sm text-gray-500">
            <p>&copy; 2025 | á€•á€»á€±á€¬á€ºá€›á€½á€¾á€„á€ºá€…á€›á€¬á€á€®á€á€„á€ºá€¸á€€á€»á€½á€á€ºá€–á€¼á€…á€ºá€•á€«á€…á€±á‹</p>
        </footer>

    </div>

    <script type="module">
        // --- Hardcoded Authentication Credentials ---
        const ADMIN_USERNAME = 'kmt';
        const ADMIN_PASSWORD = 'Thadingyut2025';
        
        // --- Firebase Globals & Setup ---
        // á€¤á€á€Šá€ºá€™á€¾á€¬ á€á€„á€·á€ºá Firestore Configuration á€–á€¼á€…á€ºá€á€Šá€º
        const firebaseConfig = {
            apiKey: "AIzaSyCJ1ZtAu_S0VBZRtyIjuKHfBalHmaeu2aw",
            authDomain: "kmtechspaceship.firebaseapp.com",
            projectId: "kmtechspaceship",
            storageBucket: "kmtechspaceship.firebasestorage.app",
            messagingSenderId: "494150534835",
            appId: "1:494150534835:web:d2b654e04d7b52ca1912c6",
            measurementId: "G-CWJ6BXN5TY"
        };
        
        // Netlify/GitHub Deployment á€¡á€á€½á€€á€º Canvas placeholders á€™á€»á€¬á€¸á€€á€­á€¯ á€–á€šá€ºá€›á€¾á€¬á€¸á€œá€­á€¯á€€á€ºá€á€Šá€ºá‹
        const appIdForPath = firebaseConfig.projectId; // Firestore path á€¡á€á€½á€€á€º Project ID (kmtechspaceship) á€€á€­á€¯ á€¡á€á€¯á€¶á€¸á€•á€¼á€¯á€á€Šá€ºá‹
        const initialAuthToken = null; // Netlify á€á€½á€„á€º Custom Auth Token á€™á€›á€¾á€­á€•á€«

        let db, auth;
        let userId = null;
        let gameData = null;

        // Firestore Path (Project ID á€€á€­á€¯ á€¡á€á€¯á€¶á€¸á€•á€¼á€¯á€‘á€¬á€¸á€•á€«á€á€Šá€º)
        const GAME_DOC_PATH = `artifacts/${appIdForPath}/public/data/thadingyut_game/config`;


        // --- Default Data ---
        const defaultData = {
            totalAmount: 30000,
            minAmount: 3000,
            maxAmount: 7000,
            teamMembers: [
                "sis TTM", "sis TWN", "sis NHHM", "sis EMT", "bro YHA",
                "sis LLO", "sis PDL", "sis ZMO", "bro KMT"
            ].join('\n')
        };

        // Default Prize Configuration (9 unique amounts that sum to 30000)
        const DEFAULT_PRIZES = [
            { colorName: "á€›á€½á€¾á€±á€›á€±á€¬á€„á€º", hex: "#FFD700", amount: 7000, allocated: false },
            { colorName: "á€•á€á€¹á€á€™á€¼á€¬á€¸á€”á€®", hex: "#D81B60", amount: 6000, allocated: false },
            { colorName: "á€€á€¼á€±á€¸á€”á€®á€›á€±á€¬á€„á€º", hex: "#CD7F32", amount: 4500, allocated: false },
            { colorName: "á€™á€¼á€›á€±á€¬á€„á€º", hex: "#00A86B", amount: 3000, allocated: false },
            { colorName: "á€”á€®á€œá€¬á€•á€¼á€¬", hex: "#4169E1", amount: 3500, allocated: false },
            { colorName: "á€„á€½á€±á€›á€±á€¬á€„á€º", hex: "#C0C0C0", amount: 2500, allocated: false },
            { colorName: "á€œá€­á€™á€¹á€™á€±á€¬á€ºá€›á€±á€¬á€„á€º", hex: "#FF8C00", amount: 1500, allocated: false },
            { colorName: "á€›á€½á€€á€ºá€…á€­á€™á€ºá€¸á€›á€±á€¬á€„á€º", hex: "#8FBC8F", amount: 3000, allocated: false },
            { colorName: "á€á€›á€™á€ºá€¸á€›á€±á€¬á€„á€º", hex: "#8A2BE2", amount: 3500, allocated: false },
        ];


        // --- DOM Elements ---
        const loadingScreenEl = document.getElementById('loading-screen');
        const loginSectionEl = document.getElementById('login-section');
        const adminPanelEl = document.getElementById('admin-panel');
        const gameViewEl = document.getElementById('game-view');
        const adminLoginBtn = document.getElementById('admin-login-btn');
        const closeAdminBtn = document.getElementById('close-admin-btn');
        const loginForm = document.getElementById('login-form');
        const adminForm = document.getElementById('admin-form');
        const loginErrorEl = document.getElementById('login-error');
        const adminMessageEl = document.getElementById('admin-message');
        const memberCountEl = document.getElementById('member-count');
        const prizeSetupContainerEl = document.getElementById('prize-setup-container');
        const adminResultsTableEl = document.getElementById('admin-results-table');
        const spinnerSelectEl = document.getElementById('spinner-select');
        const wheelEl = document.getElementById('wheel');
        const generateBtn = document.getElementById('generate-btn');
        const spinStatusEl = document.getElementById('spin-status');
        const individualResultEl = document.getElementById('individual-result');
        const resultColorDisplayEl = document.getElementById('result-color-display');
        const resetInfoEl = document.getElementById('reset-info');

        // --- Core Functions ---

        async function initFirebase() {
            try {
                if (firebaseConfig && firebaseConfig.projectId) {
                    const app = firebase.initializeApp(firebaseConfig);
                    db = firebase.getFirestore(app);
                    auth = firebase.getAuth(app);
                    firebase.setLogLevel('error'); 

                    // Auth login
                    if (initialAuthToken) {
                        await firebase.signInWithCustomToken(auth, initialAuthToken);
                    } else {
                        // Netlify/GitHub deployment requires anonymous sign-in 
                        // to get request.auth != null for the security rules to work.
                        await firebase.signInAnonymously(auth); 
                    }
                    userId = auth.currentUser.uid;
                    
                    // Start listening to game state
                    setupGameListener();

                } else {
                    // Fallback to show error if config is truly missing
                    console.error("Firebase configuration is missing or incomplete.");
                }
            } catch (e) {
                console.error("Firebase Initialization Error:", e);
                // Hide loading screen but show a message
                loadingScreenEl.classList.add('hidden');
                gameViewEl.classList.remove('hidden'); 
                spinStatusEl.textContent = `âŒ á€…á€”á€…á€ºá€á€»á€­á€á€ºá€†á€€á€ºá€™á€¾á€¯ á€¡á€™á€¾á€¬á€¸á‹ (${e.message || 'Error'})`;
            }
        }
        
        function setupGameListener() {
            const docRef = firebase.doc(db, GAME_DOC_PATH);

            firebase.onSnapshot(docRef, (docSnap) => {
                if (docSnap.exists()) {
                    gameData = docSnap.data();
                    renderGameUI();
                } else {
                    // Initialize default data if not exists
                    initializeDefaultGame();
                }
            }, (error) => {
                console.error("Firestore Listener Error:", error);
            });
        }
        
        async function initializeDefaultGame() {
            const members = defaultData.teamMembers.split('\n').filter(n => n.trim() !== '');
            const initialMembers = members.map(name => ({
                name: name,
                spun: false,
                resultColor: null,
                resultAmount: null,
                spinnerId: null
            }));

            const initialData = {
                totalAmount: 30000,
                minAmount: 3000,
                maxAmount: 7000,
                teamMembers: initialMembers,
                prizes: DEFAULT_PRIZES,
                lastUpdated: new Date().toISOString()
            };

            try {
                const docRef = firebase.doc(db, GAME_DOC_PATH);
                await firebase.setDoc(docRef, initialData);
            } catch (e) {
                console.error("Failed to initialize default game data:", e);
            }
        }

        function renderGameUI() {
            if (!gameData) return;

            // 1. Hide loading and show game view
            loadingScreenEl.classList.add('hidden');
            gameViewEl.classList.remove('hidden');

            // 2. Render Wheel
            renderWheel();
            
            // 3. Render Spinner Selection & Check Status
            renderSpinnerSelection();

            // 4. Update Admin Panel if visible
            if (!adminPanelEl.classList.contains('hidden')) {
                updateAdminPanelForms();
                renderAdminResultsTable();
            }
        }
        
        function renderWheel() {
            const prizes = gameData.prizes.filter(p => !p.allocated);
            const numSegments = prizes.length;
            wheelEl.innerHTML = ''; // Clear existing segments

            if (numSegments === 0) {
                 wheelEl.innerHTML = '<div class="absolute inset-0 flex items-center justify-center text-center text-red-600 font-bold p-4 bg-gray-200/90 rounded-full">á€†á€¯á€¡á€¬á€¸á€œá€¯á€¶á€¸ á€•á€¼á€®á€¸á€†á€¯á€¶á€¸á€á€½á€¬á€¸á€•á€«á€•á€¼á€®á‹</div>';
                 return;
            }

            const anglePerSegment = 360 / numSegments;

            prizes.forEach((prize, index) => {
                const segment = document.createElement('div');
                segment.className = 'wheel-segment';
                segment.style.backgroundColor = prize.hex;
                segment.style.transform = `rotate(${index * anglePerSegment}deg) skewY(-${90 - anglePerSegment}deg)`;
                
                // Add color name overlay (optional, but good for context)
                const innerSegment = document.createElement('div');
                innerSegment.className = 'absolute top-0 left-0 w-full h-full';
                innerSegment.style.transform = `skewY(${90 - anglePerSegment}deg) rotate(0deg)`;
                innerSegment.style.paddingLeft = '50%';
                innerSegment.style.textAlign = 'center';
                innerSegment.style.fontSize = '12px';
                innerSegment.style.fontWeight = 'bold';
                innerSegment.style.color = getContrastColor(prize.hex);
                innerSegment.style.lineHeight = '64px';
                innerSegment.textContent = prize.colorName;

                segment.appendChild(innerSegment);
                wheelEl.appendChild(segment);
            });
        }
        
        function renderSpinnerSelection() {
            const members = gameData.teamMembers;
            spinnerSelectEl.innerHTML = '<option value="" disabled selected>--- á€›á€½á€±á€¸á€á€»á€šá€ºá€•á€« ---</option>';
            generateBtn.disabled = true;
            individualResultEl.classList.add('hidden');
            resetInfoEl.classList.add('hidden');
            
            let selectedMember = null;
            let firstUnspunName = null;
            
            // Find the first unspun member to auto-select
            members.forEach(member => {
                const option = document.createElement('option');
                option.value = member.name;
                option.textContent = member.name;
                if (member.spun) {
                    option.textContent += ' (á€œá€¾á€Šá€·á€ºá€•á€¼á€®á€¸)';
                    option.disabled = true;
                } else if (!firstUnspunName) {
                    firstUnspunName = member.name;
                }
                spinnerSelectEl.appendChild(option);
            });
            
            // Auto-select and setup initial state
            if (firstUnspunName) {
                spinnerSelectEl.value = firstUnspunName;
                selectedMember = members.find(m => m.name === firstUnspunName);
                if (selectedMember && !selectedMember.spun) {
                    generateBtn.disabled = false;
                    spinStatusEl.textContent = `${selectedMember.name} á€¡á€á€„á€·á€ºá€–á€¼á€…á€ºá€•á€«á€•á€¼á€®á‹`;
                }
            } else if (members.every(m => m.spun)) {
                 generateBtn.disabled = true;
                 spinStatusEl.textContent = "á€‚á€­á€™á€ºá€¸á€•á€¼á€®á€¸á€†á€¯á€¶á€¸á€•á€«á€•á€¼á€®á‹";
                 resetInfoEl.classList.remove('hidden');
            }
            
            spinnerSelectEl.onchange = function() {
                const name = spinnerSelectEl.value;
                selectedMember = members.find(m => m.name === name);

                if (selectedMember && !selectedMember.spun) {
                    generateBtn.disabled = false;
                    spinStatusEl.textContent = `${selectedMember.name} á€¡á€á€„á€·á€ºá€–á€¼á€…á€ºá€•á€«á€•á€¼á€®á‹`;
                    individualResultEl.classList.add('hidden');
                } else if (selectedMember && selectedMember.spun) {
                    generateBtn.disabled = true;
                    spinStatusEl.textContent = `âœ… ${selectedMember.name} á€á€Šá€º ${selectedMember.resultColor} á€†á€¯á€€á€­á€¯ á€›á€›á€¾á€­á€•á€¼á€®á€¸á€•á€«á€•á€¼á€®á‹`;
                    displayIndividualResult(selectedMember);
                } else {
                    generateBtn.disabled = true;
                    spinStatusEl.textContent = "";
                }
            };
        }

        // --- Spin Logic ---
        
        async function handleSpin() {
            const selectedName = spinnerSelectEl.value;
            if (!selectedName || generateBtn.disabled) return;
            
            const currentMemberIndex = gameData.teamMembers.findIndex(m => m.name === selectedName);
            const currentMember = gameData.teamMembers[currentMemberIndex];
            if (!currentMember || currentMember.spun) return;
            
            const availablePrizes = gameData.prizes.filter(p => !p.allocated);
            if (availablePrizes.length === 0) {
                spinStatusEl.textContent = "á€†á€¯á€™á€›á€¾á€­á€á€±á€¬á€·á€•á€«";
                generateBtn.disabled = true;
                return;
            }

            // 1. Select a random prize and find the angle
            const prizeIndex = Math.floor(Math.random() * availablePrizes.length);
            const selectedPrize = availablePrizes[prizeIndex];
            
            const allPrizes = gameData.prizes.filter(p => !p.allocated);
            const targetPrizeIndex = allPrizes.findIndex(p => p.colorName === selectedPrize.colorName); // Index in the current, smaller wheel
            
            const numSegments = allPrizes.length; 
            const anglePerSegment = 360 / numSegments;
            
            // Calculate a random target rotation angle
            const baseRotations = 360 * 10; 
            const targetAngle = targetPrizeIndex * anglePerSegment + (anglePerSegment / 2); // Center of the segment
            const offset = Math.random() * (anglePerSegment * 0.8) - (anglePerSegment * 0.4); // Small random offset within the segment
            const finalRotation = baseRotations + targetAngle + offset;
            
            // 2. Start the visual spin animation
            generateBtn.disabled = true;
            generateBtn.textContent = 'ğŸ”„ á€œá€¾á€Šá€·á€ºá€”á€±á€á€Šá€º...';
            spinStatusEl.textContent = "á€†á€¯á€™á€²á€€á€­á€¯ á€›á€½á€±á€¸á€á€»á€šá€ºá€”á€±á€•á€«á€á€Šá€º...";
            wheelEl.style.transition = 'transform 3s cubic-bezier(0.25, 0.46, 0.45, 0.94)';
            wheelEl.style.transform = `rotate(${finalRotation}deg)`;

            // 3. Wait for the spin animation to finish (3 seconds)
            setTimeout(async () => {
                spinStatusEl.textContent = "âœ… á€›á€œá€’á€ºá€‘á€½á€€á€ºá€•á€±á€«á€ºá€•á€«á€•á€¼á€®á‹";
                
                try {
                    const docRef = firebase.doc(db, GAME_DOC_PATH);
                    
                    // Prepare atomic updates
                    const newMembers = gameData.teamMembers.map((m, i) => {
                        if (i === currentMemberIndex) {
                            return { 
                                ...m, 
                                spun: true, 
                                resultColor: selectedPrize.colorName, 
                                resultAmount: selectedPrize.amount,
                                spinnerId: userId
                            };
                        }
                        return m;
                    });
                    
                    const newPrizes = gameData.prizes.map(p => {
                        if (p.colorName === selectedPrize.colorName) {
                            return { ...p, allocated: true };
                        }
                        return p;
                    });

                    await firebase.setDoc(docRef, {
                        ...gameData, 
                        teamMembers: newMembers, 
                        prizes: newPrizes,
                        lastUpdated: new Date().toISOString()
                    });
                    
                    displayIndividualResult({ name: selectedName, resultColor: selectedPrize.colorName });

                } catch (error) {
                    console.error("Firestore Update Error:", error);
                    spinStatusEl.textContent = "âŒ á€›á€œá€’á€ºá€á€­á€™á€ºá€¸á€†á€Šá€ºá€¸á€›á€¬á€á€½á€„á€º á€¡á€™á€¾á€¬á€¸á€–á€¼á€…á€ºá€•á€½á€¬á€¸á€•á€«á€á€Šá€ºá‹";
                    // Re-enable button on error
                    generateBtn.disabled = false;
                    generateBtn.textContent = 'ğŸ’° á€œá€¾á€Šá€·á€ºá€™á€Šá€º';
                }
            }, 3500); // 3.5 seconds to ensure animation completes
        }
        
        function displayIndividualResult(member) {
            resultColorDisplayEl.textContent = member.resultColor;
            resultColorDisplayEl.style.backgroundColor = gameData.prizes.find(p => p.colorName === member.resultColor)?.hex || '#ccc';
            individualResultEl.classList.remove('hidden');
        }

        // --- Admin Panel Functions ---

        function handleLogin(event) {
            event.preventDefault();
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;

            if (username === ADMIN_USERNAME && password === ADMIN_PASSWORD) {
                loginSectionEl.classList.add('hidden');
                adminPanelEl.classList.remove('hidden');
                loginErrorEl.classList.add('hidden');
                updateAdminPanelForms();
                renderAdminResultsTable();
            } else {
                loginErrorEl.classList.remove('hidden');
            }
        }
        
        function updateAdminPanelForms() {
            document.getElementById('total-amount').value = gameData.totalAmount;
            document.getElementById('min-amount').value = gameData.minAmount;
            document.getElementById('max-amount').value = gameData.maxAmount;
            memberCountEl.textContent = gameData.teamMembers.length;
            
            // Reconstruct team member list for textarea
            document.getElementById('team-members').value = gameData.teamMembers.map(m => m.name).join('\n');
            
            // Render prize setup inputs
            renderPrizeSetupForms();
        }

        function renderPrizeSetupForms() {
            prizeSetupContainerEl.innerHTML = '';
            gameData.prizes.forEach((prize, index) => {
                const div = document.createElement('div');
                div.className = 'grid grid-cols-5 gap-2 items-center';
                
                const colorInput = `<input type="color" data-index="${index}" class="col-span-1 w-full h-8 rounded-md" value="${prize.hex}">`;
                const nameInput = `<input type="text" data-index="${index}" data-field="colorName" placeholder="á€¡á€›á€±á€¬á€„á€ºá€¡á€™á€Šá€º" class="col-span-2 p-1 text-sm rounded-md" value="${prize.colorName}">`;
                const amountInput = `<input type="number" data-index="${index}" data-field="amount" placeholder="á€•á€™á€¬á€ MMK" class="col-span-2 p-1 text-sm rounded-md" value="${prize.amount}" min="100">`;

                div.innerHTML = `${colorInput}${nameInput}${amountInput}`;
                prizeSetupContainerEl.appendChild(div);
            });
            
            // Add listeners for color/amount changes (to update temp data)
            prizeSetupContainerEl.querySelectorAll('input').forEach(input => {
                input.addEventListener('input', () => {
                    const index = parseInt(input.getAttribute('data-index'));
                    const field = input.getAttribute('data-field');

                    // Check if index is valid and update temp gameData object
                    if (index >= 0 && index < gameData.prizes.length) {
                        if (input.type === 'color') {
                            gameData.prizes[index].hex = input.value;
                        } else if (field) {
                             gameData.prizes[index][field] = field === 'amount' ? parseInt(input.value) : input.value;
                        }
                    }
                    
                    // Simple validation check
                    const newMembersCount = document.getElementById('team-members').value.split('\n').filter(n => n.trim() !== '').length;
                    
                    if (newMembersCount !== gameData.prizes.length) {
                         adminMessageEl.textContent = `á€á€á€­! á€¡á€–á€½á€²á€·á€á€„á€ºá€¦á€¸á€›á€± (${newMembersCount}) á€”á€¾á€„á€·á€º á€†á€¯á€¦á€¸á€›á€± (${gameData.prizes.length}) á€™á€á€°á€Šá€®á€•á€«á‹ á€†á€¯á€™á€»á€¬á€¸á€€á€­á€¯ á‰ á€á€¯á€á€­á€á€­ á€•á€¼á€„á€ºá€†á€„á€ºá€•á€«á‹`;
                         adminMessageEl.classList.remove('hidden');
                         adminMessageEl.classList.add('text-red-600');
                    } else {
                         adminMessageEl.classList.add('hidden');
                    }
                });
            });
        }
        
        // --- Function to reset a specific member's spin ---
        async function resetMemberSpin(memberIndex) {
            if (!gameData || memberIndex < 0 || memberIndex >= gameData.teamMembers.length) return;

            const member = gameData.teamMembers[memberIndex];
            if (!member.spun) return; // Only reset if they have spun

            const docRef = firebase.doc(db, GAME_DOC_PATH);
            
            // 1. Unallocate the prize color
            const newPrizes = gameData.prizes.map(p => {
                if (p.colorName === member.resultColor) {
                    return { ...p, allocated: false };
                }
                return p;
            });

            // 2. Reset member's status
            const newMembers = gameData.teamMembers.map((m, i) => {
                if (i === memberIndex) {
                    return { ...m, spun: false, resultColor: null, resultAmount: null, spinnerId: null };
                }
                return m;
            });

            try {
                await firebase.setDoc(docRef, {
                    ...gameData,
                    teamMembers: newMembers,
                    prizes: newPrizes,
                    lastUpdated: new Date().toISOString()
                });
                // Success message will be displayed via the onSnapshot listener refresh
            } catch (e) {
                console.error("Failed to reset member spin:", e);
                displayAdminMessage(`âŒ ${member.name} á á€›á€œá€’á€º á€•á€¼á€”á€ºá€œá€Šá€ºá€á€á€ºá€™á€¾á€á€ºá€›á€”á€º á€™á€¡á€±á€¬á€„á€ºá€™á€¼á€„á€ºá€•á€«á‹`, 'red');
            }
        }

        function renderAdminResultsTable() {
            adminResultsTableEl.innerHTML = '';
            
            const totalAmount = gameData.totalAmount;
            let currentTotal = 0;

            gameData.teamMembers.forEach((member, index) => {
                const tr = document.createElement('tr');
                tr.className = member.spun ? 'bg-green-50/50 border-b border-gray-100' : 'bg-white border-b border-gray-100';
                
                let amountDisplay = member.resultAmount ? member.resultAmount.toLocaleString() : '-';
                let colorDisplay = member.resultColor ? `<span class="font-semibold" style="color: ${gameData.prizes.find(p => p.colorName === member.resultColor)?.hex || '#333'}">${member.resultColor}</span>` : '-';
                let status = member.spun ? 'âœ… á€œá€¾á€Šá€·á€ºá€•á€¼á€®á€¸' : 'â³ á€™á€œá€¾á€Šá€·á€ºá€›á€á€±á€¸';

                if (member.resultAmount) {
                    currentTotal += member.resultAmount;
                }
                
                // Reset Button
                const resetButton = document.createElement('button');
                resetButton.className = 'text-xs py-1 px-2 rounded font-semibold transition-colors';
                resetButton.setAttribute('data-index', index);
                
                if (member.spun) {
                    resetButton.textContent = 'á€•á€¼á€”á€ºá€•á€¼á€„á€ºá€™á€Šá€º';
                    resetButton.classList.add('bg-yellow-500', 'hover:bg-yellow-600', 'text-white');
                    resetButton.addEventListener('click', (e) => {
                        const idx = parseInt(e.target.getAttribute('data-index'));
                        // IMPORTANT: Use standard confirmation dialog as custom modals are complex for this context
                        if (confirm(`á€á€±á€á€»á€¬á€•á€«á€á€œá€¬á€¸? ${gameData.teamMembers[idx].name} á€›á€²á€· á€›á€œá€’á€ºá€€á€­á€¯ á€•á€¼á€”á€ºá€–á€»á€€á€ºá€•á€¼á€®á€¸ á€†á€¯á€€á€­á€¯ á€•á€¼á€”á€ºá€‘á€Šá€·á€ºá€•á€±á€¸á€•á€«á€™á€Šá€ºá‹`)) {
                            resetMemberSpin(idx);
                        }
                    });
                } else {
                    resetButton.textContent = 'N/A';
                    resetButton.disabled = true;
                    resetButton.classList.add('bg-gray-200', 'text-gray-500');
                }
                
                const resetTd = document.createElement('td');
                resetTd.className = 'p-3 text-center';
                resetTd.appendChild(resetButton);


                tr.innerHTML = `
                    <td class="p-3 font-semibold">${member.name}</td>
                    <td class="p-3 text-center text-sm ${member.spun ? 'text-green-700' : 'text-yellow-700'}">${status}</td>
                    <td class="p-3 text-center text-sm">${colorDisplay}</td>
                    <td class="p-3 text-right font-mono font-bold text-red-700">${amountDisplay}</td>
                `;
                tr.appendChild(resetTd); // Append the reset button column
                adminResultsTableEl.appendChild(tr);
            });

            // Summary row
            const totalRow = document.createElement('tr');
            totalRow.className = 'bg-green-200 font-bold';
            totalRow.innerHTML = `
                <td class="p-3 text-left">á€…á€¯á€…á€¯á€•á€±á€«á€„á€ºá€¸:</td>
                <td class="p-3 text-center">${gameData.teamMembers.filter(m => m.spun).length} / ${gameData.teamMembers.length}</td>
                <td class="p-3 text-center"></td>
                <td class="p-3 text-right">${currentTotal.toLocaleString()} / ${totalAmount.toLocaleString()} MMK</td>
                <td class="p-3 text-center"></td>
            `;
            adminResultsTableEl.appendChild(totalRow);
        }

        async function handleAdminSave(event) {
            event.preventDefault();

            const newTotal = parseInt(document.getElementById('total-amount').value);
            const newMin = parseInt(document.getElementById('min-amount').value);
            const newMax = parseInt(document.getElementById('max-amount').value);
            const newMembersText = document.getElementById('team-members').value;
            const membersArray = newMembersText.split('\n').filter(n => n.trim() !== '');

            const totalMinRequired = membersArray.length * newMin;
            const totalMaxRequired = membersArray.length * newMax;
            
            // Validation 1: Min/Max/Total Check
            if (newTotal < totalMinRequired || newTotal > totalMaxRequired) {
                displayAdminMessage(`âŒ á€™á€™á€¾á€”á€ºá€€á€”á€ºá€•á€«á‹ á€…á€¯á€…á€¯á€•á€±á€«á€„á€ºá€¸á€„á€½á€±á€•á€™á€¬á€á€á€Šá€º ${membersArray.length} á€šá€±á€¬á€€á€ºá€¡á€á€½á€€á€º ${totalMinRequired.toLocaleString()} MMK á€™á€¾ ${totalMaxRequired.toLocaleString()} MMK á€¡á€á€½á€„á€ºá€¸ á€–á€¼á€…á€ºá€›á€•á€«á€™á€Šá€ºá‹`, 'red');
                return;
            }
            
            // Validation 2: Prize Count Check
            if (membersArray.length !== gameData.prizes.length) {
                displayAdminMessage(`âŒ á€¡á€–á€½á€²á€·á€á€„á€ºá€¦á€¸á€›á€± (${membersArray.length}) á€”á€¾á€„á€·á€º á€†á€¯á€¦á€¸á€›á€± (${gameData.prizes.length}) á€™á€á€°á€Šá€®á€•á€«á‹ á€†á€¯á€™á€»á€¬á€¸á€€á€­á€¯ á‰ á€á€¯á€á€­á€á€­ á€•á€¼á€„á€ºá€†á€„á€ºá€•á€«á‹`, 'red');
                return;
            }

            // Validation 3: Prize Sum Check
            const prizeSum = gameData.prizes.reduce((sum, p) => sum + parseInt(p.amount), 0);
            if (prizeSum !== newTotal) {
                 displayAdminMessage(`âŒ á€†á€¯á€™á€»á€¬á€¸á á€…á€¯á€…á€¯á€•á€±á€«á€„á€ºá€¸á€•á€™á€¬á€ (${prizeSum.toLocaleString()} MMK) á€á€Šá€º á€…á€¯á€…á€¯á€•á€±á€«á€„á€ºá€¸á€„á€½á€± (${newTotal.toLocaleString()} MMK) á€”á€¾á€„á€·á€º á€™á€á€°á€Šá€®á€•á€«á‹`, 'red');
                 return;
            }

            // Map old members to new members, maintaining spun status if name is the same
            const oldMembers = gameData.teamMembers;
            const updatedMembers = membersArray.map(name => {
                const existing = oldMembers.find(m => m.name === name);
                // Reset all status for new configuration to ensure a fresh game start
                return { name: name, spun: false, resultColor: null, resultAmount: null, spinnerId: null };
            });
            
            // Create a new prize array based on current form values, resetting allocation status
            const newPrizes = gameData.prizes.map(p => ({
                colorName: p.colorName,
                hex: p.hex,
                amount: parseInt(p.amount),
                allocated: false // Reset allocation when new config is saved
            }));


            const newData = {
                totalAmount: newTotal,
                minAmount: newMin,
                maxAmount: newMax,
                teamMembers: updatedMembers, 
                prizes: newPrizes,
                lastUpdated: new Date().toISOString()
            };

            try {
                const docRef = firebase.doc(db, GAME_DOC_PATH);
                await firebase.setDoc(docRef, newData);
                displayAdminMessage('âœ… á€¡á€á€»á€€á€ºá€¡á€œá€€á€ºá€™á€»á€¬á€¸ á€¡á€±á€¬á€„á€ºá€™á€¼á€„á€ºá€…á€½á€¬ á€á€­á€™á€ºá€¸á€†á€Šá€ºá€¸á€•á€¼á€®á€¸áŠ á€‚á€­á€™á€ºá€¸á€¡á€á€¼á€±á€¡á€”á€±á€€á€­á€¯ á€•á€¼á€”á€ºá€œá€Šá€ºá€á€á€ºá€™á€¾á€á€ºá€œá€­á€¯á€€á€ºá€•á€«á€•á€¼á€®á‹', 'green');
            } catch (e) {
                console.error("Firestore Save Error:", e);
                displayAdminMessage('âŒ á€á€­á€™á€ºá€¸á€†á€Šá€ºá€¸á€›á€”á€º á€¡á€™á€¾á€¬á€¸á€›á€¾á€­á€”á€±á€•á€«á€á€Šá€ºá‹', 'red');
            }
        }
        
        function displayAdminMessage(message, type) {
            adminMessageEl.textContent = message;
            adminMessageEl.classList.remove('hidden', 'text-green-600', 'text-red-600');
            adminMessageEl.classList.add(type === 'green' ? 'text-green-600' : 'text-red-600');
            setTimeout(() => {
                adminMessageEl.classList.add('hidden');
            }, 5000);
        }

        function toggleLogin() {
            loginSectionEl.classList.toggle('hidden');
            adminPanelEl.classList.add('hidden'); // Close admin panel if open
            loginErrorEl.classList.add('hidden');
            document.getElementById('username').value = '';
            document.getElementById('password').value = '';
        }

        function closeAdminPanel() {
            adminPanelEl.classList.add('hidden');
            loginSectionEl.classList.add('hidden');
            adminMessageEl.classList.add('hidden');
            // Re-render the wheel in case the user edited but didn't save
            renderGameUI(); 
        }
        
        // --- Helper Function ---
        function getContrastColor(hex) {
            // Simple check to determine if text should be black or white
            if (!hex || hex.indexOf('#') === -1) return '#000000';
            const r = parseInt(hex.substring(1, 3), 16);
            const g = parseInt(hex.substring(3, 5), 16);
            const b = parseInt(hex.substring(5, 7), 16);
            const yiq = ((r * 299) + (g * 587) + (b * 114)) / 1000;
            return (yiq >= 128) ? '#000000' : '#ffffff';
        }

        // --- Event Listeners and Initialization ---
        document.addEventListener('DOMContentLoaded', () => {
            initFirebase();
            generateBtn.addEventListener('click', handleSpin);
            loginForm.addEventListener('submit', handleLogin);
            adminForm.addEventListener('submit', handleAdminSave);
            adminLoginBtn.addEventListener('click', toggleLogin);
            closeAdminBtn.addEventListener('click', closeAdminPanel);
        });

    </script>
</body>
</html>
